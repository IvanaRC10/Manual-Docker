# Comandos básicos y útiles de Docker
**Nombre:** Ivana Rocha Campos  
**Número de control:** 1222100460  
**Asignatura:** Gestión del Proceso de Desarrollo de Software – Unidad II  

---

## Índice
1. [Docker Engine](#docker-engine)
2. [Docker Compose](#docker-compose)
3. [Docker Swarm](#docker-swarm)
4. [Imágenes y contenedores](#imágenes-y-contenedores)
5. [Limpieza y mantenimiento](#limpieza-y-mantenimiento)
6. [Redes y volúmenes](#redes-y-volúmenes)
7. [Volúmenes en Docker](#volúmenes-en-docker)
8. [Seguridad y configuración avanzada](#seguridad-y-configuración-avanzada)
9. [Inspección y diagnóstico](#inspección-y-diagnóstico)
10. [Comandos combinados útiles](#comandos-combinados-útiles)
11. [Referencias](#referencias)

---

## Definición general
Docker es una plataforma de contenedorización que permite crear, implementar y ejecutar aplicaciones de manera aislada mediante contenedores. Estos contenedores permiten que el software se ejecute de forma uniforme en cualquier entorno, evitando conflictos de configuración y dependencias.

---

## Docker Engine  
Docker Engine es el componente principal de Docker. Es el motor que ejecuta, construye y gestiona los contenedores.

### Comandos y descripciones

**Muestra la versión instalada de Docker.**  
```shell
docker --version
```

**Descarga una imagen del repositorio de Docker Hub.**  
```shell
docker pull <imagen>
```

**Construye una imagen a partir de un archivo Dockerfile.**  
```shell
docker build -t <nombre_imagen> .
```

**Lista las imágenes disponibles en el sistema.**  
```shell
docker images
```

**Crea y ejecuta un contenedor en segundo plano.**  
```shell
docker run -d --name <nombre_contenedor> -p 80:80 <imagen>
```

**Muestra los contenedores actualmente en ejecución.**  
```shell
docker ps
```

**Muestra todos los contenedores (activos e inactivos).**  
```shell
docker ps -a
```

**Permite acceder a un contenedor en ejecución mediante terminal.**  
```shell
docker exec -it <nombre_contenedor> /bin/sh
```

**Detiene un contenedor en ejecución.**  
```shell
docker stop <nombre_contenedor>
```

**Elimina un contenedor detenido.**  
```shell
docker rm <nombre_contenedor>
```

**Elimina una imagen almacenada localmente.**  
```shell
docker rmi <nombre_imagen>
```

---

## Docker Compose  
Docker Compose es una herramienta para definir y ejecutar aplicaciones multicontenedor mediante archivos YAML.

### Comandos y descripciones

**Muestra la versión instalada de Docker Compose.**  
```shell
docker compose version
```

**Levanta los servicios definidos en el archivo docker-compose.yml.**  
```shell
docker compose up -d
```

**Detiene y elimina los contenedores creados con Compose.**  
```shell
docker compose down
```

**Reinicia todos los servicios definidos en el archivo Compose.**  
```shell
docker compose restart
```

**Reconstruye las imágenes de los servicios.**  
```shell
docker compose build
```

**Muestra los logs generados por los servicios.**  
```shell
docker compose logs
```

**Lista los contenedores que forman parte del proyecto Compose.**  
```shell
docker compose ps
```

---

## Docker Swarm  
Docker Swarm permite la orquestación de múltiples contenedores y hosts para crear clústeres distribuidos.

### Comandos y descripciones

**Inicializa un nuevo clúster de Swarm.**  
```shell
docker swarm init
```

**Muestra los nodos activos dentro del clúster Swarm.**  
```shell
docker node ls
```

**Despliega un stack a partir de un archivo YAML.**  
```shell
docker stack deploy -c <archivo>.yml <nombre_stack>
```

**Lista los stacks activos dentro del Swarm.**  
```shell
docker stack ls
```

**Muestra los servicios activos dentro de un stack.**  
```shell
docker stack services <nombre_stack>
```

**Elimina un stack del clúster.**  
```shell
docker stack rm <nombre_stack>
```

**Escala un servicio del Swarm.**  
```shell
docker service scale <nombre_servicio>=3
```

**Actualiza una imagen dentro de un servicio Swarm.**  
```shell
docker service update --image <nueva_imagen> <nombre_servicio>
```

---

## Imágenes y contenedores  
Permiten administrar y manipular las imágenes y contenedores dentro del sistema.

### Comandos y descripciones

**Renombra un contenedor existente.**  
```shell
docker rename <nombre_viejo> <nombre_nuevo>
```

**Guarda una imagen en un archivo .tar para exportarla.**  
```shell
docker save -o <archivo>.tar <nombre_imagen>
```

**Carga una imagen desde un archivo .tar.**  
```shell
docker load -i <archivo>.tar
```

**Pausa la ejecución de un contenedor.**  
```shell
docker pause <nombre_contenedor>
```

**Reanuda un contenedor pausado.**  
```shell
docker unpause <nombre_contenedor>
```

**Muestra el historial de cambios de una imagen.**  
```shell
docker history <nombre_imagen>
```

**Crea una nueva imagen desde los cambios de un contenedor.**  
```shell
docker commit <nombre_contenedor> <nueva_imagen>
```

---

## Limpieza y mantenimiento  
Ayuda a mantener limpio el entorno Docker y liberar espacio.

### Comandos y descripciones

**Elimina todos los recursos no utilizados (contenedores, redes, imágenes, etc.).**  
```shell
docker system prune -a
```

**Muestra el uso de recursos en tiempo real.**  
```shell
docker stats
```

**Muestra información detallada del sistema Docker.**  
```shell
docker info
```

**Elimina contenedores detenidos.**  
```shell
docker container prune
```

**Elimina volúmenes no utilizados.**  
```shell
docker volume prune
```

---

## Redes y volúmenes  
Permiten conectar contenedores entre sí o con el host mediante redes virtuales y manejar almacenamiento persistente.

### Redes en Docker

**Lista todas las redes existentes.**  
```shell
docker network ls
```

**Crea una red personalizada.**  
```shell
docker network create <nombre_red>
```

**Conecta un contenedor a una red específica.**  
```shell
docker network connect <nombre_red> <nombre_contenedor>
```

**Desconecta un contenedor de una red.**  
```shell
docker network disconnect <nombre_red> <nombre_contenedor>
```

**Elimina una red.**  
```shell
docker network rm <nombre_red>
```

**Inspecciona los detalles de una red.**  
```shell
docker network inspect <nombre_red>
```

### Volúmenes en Docker

**Lista todos los volúmenes existentes.**  
```shell
docker volume ls
```

**Crea un nuevo volumen.**  
```shell
docker volume create <nombre_volumen>
```

**Muestra los detalles de un volumen específico.**  
```shell
docker volume inspect <nombre_volumen>
```

**Elimina un volumen.**  
```shell
docker volume rm <nombre_volumen>
```

**Monta un volumen en un contenedor.**  
```shell
docker run -v <nombre_volumen>:/ruta/en/contenedor <imagen>
```

---

## Seguridad y configuración avanzada  
Permite aplicar configuraciones seguras y límites de recursos.

### Comandos y descripciones

**Escanea vulnerabilidades en una imagen.**  
```shell
docker scan <nombre_imagen>
```

**Limita la memoria RAM disponible para un contenedor.**  
```shell
docker run -m 512m <imagen>
```

**Limita el uso de CPU para un contenedor.**  
```shell
docker run --cpus=".5" <imagen>
```

**Ejecuta un contenedor en modo de solo lectura.**  
```shell
docker run --read-only <imagen>
```

**Copia archivos desde el host al contenedor.**  
```shell
docker cp <archivo_local> <nombre_contenedor>:/ruta/destino
```

**Copia archivos desde el contenedor al host.**  
```shell
docker cp <nombre_contenedor>:/ruta/archivo <ruta_local>
```

---

## Inspección y diagnóstico  
Permite analizar el estado, configuración y consumo de recursos de los contenedores.

### Comandos y descripciones

**Muestra detalles técnicos de un contenedor.**  
```shell
docker inspect <nombre_contenedor>
```

**Muestra los procesos que se ejecutan dentro de un contenedor.**  
```shell
docker top <nombre_contenedor>
```

**Muestra los logs en tiempo real de un contenedor.**  
```shell
docker logs -f <nombre_contenedor>
```

**Muestra los eventos del sistema Docker.**  
```shell
docker events
```

**Muestra el uso de almacenamiento en Docker.**  
```shell
docker system df
```

**Filtra información específica del contenedor (por ejemplo, su IP).**  
```shell
docker inspect -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}' <nombre_contenedor>
```

**Verifica si un contenedor está saludable según su configuración.**  
```shell
docker inspect --format='{{.State.Health.Status}}' <nombre_contenedor>
```

**Muestra la fecha y hora de inicio de un contenedor.**  
```shell
docker inspect -f '{{.State.StartedAt}}' <nombre_contenedor>
```

**Obtiene el nombre de la imagen base de un contenedor.**  
```shell
docker inspect -f '{{.Config.Image}}' <nombre_contenedor>
```

**Revisa el consumo de red de los contenedores.**  
```shell
docker stats --no-stream --format "table {{.Name}}\t{{.NetIO}}"
```

**Verifica qué puertos están mapeados en un contenedor.**  
```shell
docker port <nombre_contenedor>
```

**Revisa los últimos 50 eventos registrados por Docker.**  
```shell
docker events --since 1h --until now --format '{{json .}}' | head -n 50
```

---

## Comandos combinados útiles  

### Comandos y descripciones

**Detiene y elimina todos los contenedores activos.**  
```shell
docker stop $(docker ps -aq) && docker rm $(docker ps -aq)
```

**Elimina todas las imágenes almacenadas.**  
```shell
docker rmi $(docker images -q)
```

**Muestra únicamente los IDs de contenedores.**  
```shell
docker ps -aq
```

**Busca un contenedor específico por nombre.**  
```shell
docker ps | grep <nombre>
```

**Muestra la dirección IP de un contenedor.**  
```shell
docker inspect -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}' <contenedor>
```

**Detiene y elimina todos los contenedores y limpia imágenes sin usar.**  
```shell
docker stop $(docker ps -aq) && docker rm $(docker ps -aq) && docker image prune -a -f
```

**Elimina todos los volúmenes y redes no utilizados.**  
```shell
docker volume prune -f && docker network prune -f
```

**Muestra solo los contenedores que usan más de cierto porcentaje de CPU.**  
```shell
docker stats --no-stream --format "{{.Name}}: {{.CPUPerc}}" | grep -E '[5-9][0-9]\.|100\.'
```

**Exporta todos los contenedores detenidos a archivos .tar.**  
```shell
for c in $(docker ps -a -q); do docker export $c > contenedor_$c.tar; done
```

**Elimina imágenes con más de 30 días de antigüedad.**  
```shell
docker image prune -a --filter "until=720h"
```

---

## Referencias
- [Documentación oficial de Docker](https://docs.docker.com/)
- [Guía de Docker Compose](https://docs.docker.com/compose/)
- [Guía de Docker Swarm](https://docs.docker.com/engine/swarm/)
- [Redes en Docker](https://docs.docker.com/network/)
- [Gestión de volúmenes](https://docs.docker.com/storage/volumes/)
- [Seguridad y buenas prácticas](https://docs.docker.com/develop/security/)

---
